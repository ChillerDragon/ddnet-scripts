#!/usr/bin/env python3

import sys
import re

offset = int(sys.argv[2])

print('{| class="wikitable"')
print(f"! <translate><!--T:{offset+1}--> Command</translate>")
print(f"! <translate><!--T:{offset+2}--> Arguments</translate>")
print(f"! <translate><!--T:{offset+3}--> Description</translate>")

def escape(inp):
    return inp.replace("|", "<nowiki>|</nowiki>")

commands = {
    "save_dry": 0,
    "mute": 1,
    "pause": 2,
    "pausevoted": 3,
    "top5points": 4,
    "unweapons": 5,
    "unban_all": 6,
    "chat": 7,
    "spec": 8,
    "tunes": 9,
    "begin_favorite_group": 10,
    "practice": 11,
    "vote_mute": 12,
    "add_foe": 13,
    "+prevweapon": 14,
    "auth_add": 15,
    "force_unpause": 16,
    "cmdlist": 17,
    "right": 18,
    "invite": 19,
    "random_unfinished_map": 20,
    "remove_vote": 21,
    "tune_reset": 22,
    "r": 23,
    "change_map": 24,
    "screenshot": 25,
    "c": 26,
    "reset": 27,
    "dummy_reset": 28,
    "saytimeall": 29,
    "auth_list": 30,
    "unlock": 31,
    "shutdown": 32,
    "force_pause": 33,
    "dump_antibot": 34,
    "+jump": 35,
    "timer": 36,
    "zoom+": 37,
    "logout": 38,
    "unmute": 39,
    "demo_speed": 40,
    "spectate_next": 41,
    "kill": 42,
    "dbg_lognetwork": 43,
    "+weapon3": 44,
    "broadcast": 45,
    "rifle": 46,
    "+weapon2": 47,
    "lock": 48,
    "access_level": 49,
    "unlivefreeze": 50,
    "removeweapon": 51,
    "toggle_local_console": 52,
    "demo_play": 53,
    "say_team": 54,
    "load": 55,
    "restart": 56,
    "minimize": 57,
    "+hook": 58,
    "benchmark_quit": 59,
    "unmuteid": 60,
    "name_bans": 61,
    "foes": 62,
    "info": 63,
    "muteip": 64,
    "pause_game": 65,
    "save": 66,
    "addweapon": 67,
    "reload": 68,
    "rules": 69,
    "switch_open": 70,
    "tune_zone_dump": 71,
    "ungrenade": 72,
    "set_view": 73,
    "zoom-": 74,
    "quit": 75,
    "bans": 76,
    "force_vote": 77,
    "uninvite": 78,
    "access_status": 79,
    "credits": 80,
    "say": 81,
    "auth_remove": 82,
    "unrifle": 83,
    "eyeemote": 84,
    "muteid": 85,
    "spectate_previous": 86,
    "up": 87,
    "shotgun": 88,
    "spectate": 89,
    "remove_foe": 90,
    "timecp": 91,
    "disconnect": 92,
    "teamtop5": 93,
    "ban": 94,
    "start_video": 95,
    "auth_add_p": 96,
    "clear_local_console": 97,
    "laser": 98,
    "tune_zone": 99,
    "w": 100,
    "name_unban": 101,
    "time": 102,
    "vote_no": 103,
    "clear_votes": 104,
    "dump_remote_console": 105,
    "freezehammer": 106,
    "showall": 107,
    "bans_save": 108,
    "down": 109,
    "+weapon5": 110,
    "ninjajetpack": 111,
    "+show_chat": 112,
    "settings": 113,
    "toggle_tune": 114,
    "name_ban": 115,
    "unshotgun": 116,
    "unban": 117,
    "me": 118,
    "remove_favorite": 119,
    "dummy_disconnect": 120,
    "showothers": 121,
    "team": 122,
    "+left": 123,
    "mutes": 124,
    "mapbug": 125,
    "unban_range": 126,
    "dummy_connect": 127,
    "console_page_down": 128,
    "unlaser": 129,
    "rankteam": 130,
    "converse": 131,
    "ping": 132,
    "random_map": 133,
    "add_favorite": 134,
    "+showhookcoll": 135,
    "+toggle": 136,
    "tune_zone_reset": 137,
    "stoprecord": 138,
    "dump_local_console": 139,
    "echo": 140,
    "unsolo": 141,
    "tp": 142,
    "console_page_up": 143,
    "+nextweapon": 144,
    "ban_region": 145,
    "ban_region_range": 146,
    "+emote": 147,
    "move": 148,
    "play": 149,
    "ninja": 150,
    "add_map_votes": 151,
    "moderate": 152,
    "demo_slice_end": 153,
    "exit": 154,
    "grenade": 155,
    "clear_remote_console": 156,
    "+weapon4": 157,
    "left": 158,
    "toggle": 159,
    "+spectate": 160,
    "+fire": 161,
    "totelecp": 162,
    "endless_hook": 163,
    "list": 164,
    "specteam": 165,
    "super": 166,
    "top": 167,
    "weapons": 168,
    "show_ips": 169,
    "auth_change_p": 170,
    "undeep": 171,
    "livefreeze": 172,
    "tele": 173,
    "tune_zone_enter": 174,
    "rescue": 175,
    "unjetpack": 176,
    "set_team_all": 177,
    "auth_change": 178,
    "help": 179,
    "dnd": 180,
    "remove_friend": 181,
    "spectate_closest": 182,
    "mapinfo": 183,
    "add_sqlserver": 184,
    "top5team": 185,
    "totele": 186,
    "demo_slice_start": 187,
    "connect": 188,
    "rank": 189,
    "save_replay": 190,
    "emote": 191,
    "friends": 192,
    "add_demomarker": 193,
    "timeout": 194,
    "teleport": 195,
    "times": 196,
    "saytime": 197,
    "specvoted": 198,
    "ban_range": 199,
    "+right": 200,
    "dump_log": 201,
    "unfreezehammer": 202,
    "move_raw": 203,
    "whisper": 204,
    "end_favorite_group": 205,
    "vote": 206,
    "tune_zone_leave": 207,
    "record": 208,
    "points": 209,
    "top5": 210,
    "add_vote": 211,
    "dump_sqlservers": 212,
    "rcon_login": 213,
    "set_team_ddr": 214,
    "unendless_hook": 215,
    "+weapon1": 216,
    "set_team": 217,
    "stop_video": 218,
    "kick": 219,
    "vote_unmute": 220,
    "callvote": 221,
    "rcon_auth": 222,
    "status": 223,
    "kill_pl": 224,
    "tune": 225,
    "add_friend": 226,
    "exec": 227,
    "toggle_remote_console": 228,
    "teamrank": 229,
    "zoom": 230,
    "unsuper": 231,
    "rcon": 232,
    "swap": 233,
    "jetpack": 234,
    "vote_mutes": 235,
    "map": 236,
    # add new commands below here with increasing numbers
    "ban2": 237,
    "spectate_multiview": 238,
    "goto_switch": 239,
    "goto_tele": 240,
    "unninja": 241,
    "lasttp": 242,
    "solo": 243,
    "deep": 244,
}

# workaround for ban appearing twice
had_ban = False

for line in sys.stdin:
  if sys.argv[1] not in line:
    continue

  x = re.findall(r'(?:[^\s,"]|"(?:\\.|[^"])*")+', line)
  y = line.split('"')

  idx = offset + 100 + commands[y[1]]*5
  if y[1] == "ban":
      if had_ban:
        idx = offset + 100 + commands["ban2"]*5
      had_ban = True
  print("|-")
  print("|", escape(y[1]))
  if y[3].strip() == "":
    print("|")
  else:
    print(f"| <translate><!--T:{idx}--> {escape(y[3])}</translate>")
  if y[-2].strip() == "":
    print("|")
  else:
    print(f"| <translate><!--T:{idx+1}--> {escape(y[-2])}</translate>")

print('|}')

